<UserControl
    x:Class="ContextWinUI.Views.ContextAnalysisView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:components="using:ContextWinUI.Views.Components">

	<Grid Background="{ThemeResource LayerFillColorDefaultBrush}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<Grid Grid.Row="0" Padding="8,8" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,0,0,1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>

			<Button Grid.Column="0" Content="&#xE72B;" FontFamily="Segoe MDL2 Assets"
                    Command="{x:Bind ContextViewModel.GoBackCommand}"
                    Visibility="{x:Bind ContextViewModel.CanGoBack, Mode=OneWay}"
                    Background="Transparent" BorderThickness="0" Margin="0,0,8,0"/>

			<StackPanel Grid.Column="1" VerticalAlignment="Center">
				<TextBlock Text="Análise de Contexto" Style="{StaticResource SubtitleTextBlockStyle}"/>
				<TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12">
                    <Run Text="Itens Selecionados:"/>
                    <Run Text="{x:Bind ContextViewModel.SelectedCount, Mode=OneWay}"/>
				</TextBlock>
			</StackPanel>

			<components:ExpandCollapseActions Grid.Column="2" 
                                              ExpandAllCommand="{x:Bind ContextViewModel.TreeVM.ExpandAllCommand}"
                                              CollapseAllCommand="{x:Bind ContextViewModel.TreeVM.CollapseAllCommand}"
                                              Margin="0,0,8,0"/>

			<Button Grid.Column="3" Content="✕" Command="{x:Bind ContextViewModel.CloseCommand}" FontSize="16" Width="32" Height="32" Padding="0"/>
		</Grid>

		<Pivot Grid.Row="1">
			<PivotItem Header="Árvore">
				<components:ContextTreeView ViewModel="{x:Bind ContextViewModel.TreeVM, Mode=OneWay}" />
			</PivotItem>
			<PivotItem Header="Seleção">
				<components:ContextSelectionView ViewModel="{x:Bind ContextViewModel.SelectionVM, Mode=OneWay}" />
			</PivotItem>
			<PivotItem Header="Git">
				<components:ContextGitView ViewModel="{x:Bind ContextViewModel.GitVM, Mode=OneWay}" />
			</PivotItem>
		</Pivot>

		<Grid Grid.Row="2" Padding="16" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,1,0,0">
			<Button HorizontalAlignment="Stretch" Style="{StaticResource AccentButtonStyle}" Command="{x:Bind ContextViewModel.CopyContextToClipboardCommand}">
				<StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
					<FontIcon Glyph="&#xE8C8;"/>
					<TextBlock Text="Copiar Conteúdo Selecionado"/>
				</StackPanel>
			</Button>
		</Grid>

		<Grid Grid.RowSpan="3" Background="{ThemeResource LayerFillColorDefaultBrush}" Visibility="{x:Bind ContextViewModel.IsLoading, Mode=OneWay}">
			<ProgressRing IsActive="True" Width="50" Height="50"/>
		</Grid>
	</Grid>
</UserControl>