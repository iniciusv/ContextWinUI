<UserControl
    x:Class="ContextWinUI.Views.FileExplorerView"
    x:Name="RootExplorerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:models="using:ContextWinUI.Models"
    xmlns:components="using:ContextWinUI.Views.Components"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

	<Grid Background="{ThemeResource LayerFillColorDefaultBrush}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<Grid Grid.Row="0" Margin="16,12">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>
			<TextBlock Text="Arquivos" Style="{StaticResource SubtitleTextBlockStyle}" VerticalAlignment="Center"/>

			<components:ExpandCollapseActions Grid.Column="1" 
                                              SyncFocusCommand="{x:Bind ExplorerViewModel.SyncFocusCommand}"
                                              ExpandAllCommand="{x:Bind ExplorerViewModel.ExpandAllCommand}"
                                              CollapseAllCommand="{x:Bind ExplorerViewModel.CollapseAllCommand}"/>
		</Grid>

		<components:SearchBar Grid.Row="1" 
                              SearchCommand="{x:Bind ExplorerViewModel.SearchCommand}" 
                              Margin="16,0,16,8"/>

		<Grid Grid.Row="2" Padding="16,8">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>
			<Button Content="Selecionar Todos" Command="{x:Bind SelectionViewModel.SelectAllCommand}" Style="{StaticResource AccentButtonStyle}" Margin="0,0,8,0" FontSize="12" Padding="8,4"/>
			<Button Grid.Column="1" Content="Limpar" Command="{x:Bind SelectionViewModel.UnselectAllCommand}" Margin="0,0,8,0" FontSize="12" Padding="8,4"/>
			<TextBlock Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right" FontSize="12" Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                <Run Text="{x:Bind SelectionViewModel.SelectedFilesCount, Mode=OneWay}"/>
                <Run Text="sel."/>
			</TextBlock>
		</Grid>

		<TreeView Grid.Row="3" 
                  ItemsSource="{x:Bind ExplorerViewModel.RootItems, Mode=OneWay}" 
                  SelectionMode="Single" 
                  ItemInvoked="TreeView_ItemInvoked" 
                  Expanding="TreeView_Expanding" 
                  Collapsed="TreeView_Collapsed">
			<TreeView.ItemTemplate>
				<DataTemplate x:DataType="models:FileSystemItem">
					<TreeViewItem ItemsSource="{x:Bind Children, Mode=OneWay}" 
                                  IsExpanded="{x:Bind IsExpanded, Mode=TwoWay}" 
                                  Visibility="{x:Bind Visibility, Mode=OneWay}"
                                  HasUnrealizedChildren="{x:Bind IsDirectory}">

						<StackPanel Orientation="Horizontal" Spacing="8">
							<CheckBox IsChecked="{x:Bind IsChecked, Mode=TwoWay}" 
                                      Visibility="{x:Bind IsCodeFile}" 
                                      Click="OnCheckBoxClick"
                                      MinWidth="0" Padding="0" VerticalAlignment="Center"/>

							<FontIcon Glyph="{x:Bind Icon}" FontSize="16"/>
							<TextBlock Text="{x:Bind Name}" VerticalAlignment="Center"/>
							<TextBlock Text="{x:Bind FileSizeFormatted}" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="11" VerticalAlignment="Center" Visibility="{x:Bind IsCodeFile}"/>
						</StackPanel>
					</TreeViewItem>
				</DataTemplate>
			</TreeView.ItemTemplate>
		</TreeView>
	</Grid>
</UserControl>